<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mes Équipements - EcoSense</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand"><i class="fas fa-leaf"></i> EcoSense</div>
        <ul class="nav-menu">
            <li><a href="{{ url_for('home') }}"><i class="fas fa-home"></i> Accueil</a></li>
            <li><a href="{{ url_for('equipments') }}" class="active"><i class="fas fa-plug"></i> Équipements</a></li>
            <li><a href="{{ url_for('add_usage') }}"><i class="fas fa-plus-circle"></i> Nouvelle utilisation</a></li>
            <li><a href="#"><i class="fas fa-chart-line"></i> Statistiques</a></li>
            <li><a href="#"><i class="fas fa-crystal-ball"></i> Prédictions</a></li>
            <li><a href="{{ url_for('comparisons') }}"><i class="fas fa-balance-scale"></i> Comparaisons</a></li>
            <li><a href="{{ url_for('settings') }}"><i class="fas fa-cog"></i> Paramètres</a></li>
            {% if session.is_admin == 1 %}
            <li><a href="{{ url_for('admin_panel') }}"><i class="fas fa-shield-alt"></i> Admin</a></li>
            {% endif %}
            <li><a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> Déconnexion</a></li>
        </ul>
        <div class="nav-user">
            <a href="{{ url_for('profile') }}" style="color: inherit; text-decoration: none;">
                <i class="fas fa-user-circle"></i> {{ session.username }}
            </a>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1><i class="fas fa-plug"></i> Mes Équipements</h1>
            <a href="{{ url_for('add_equipment') }}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Ajouter un équipement
            </a>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% if equipments %}
            <div class="equipments-grid">
                {% for equipment in equipments %}
               <div class="equipment-card">
                    <div class="equipment-icon">
                        {% if equipment.category == 'Électroménager' %}
                            <i class="fas fa-blender"></i>
                        {% elif equipment.category == 'Multimédia' %}
                            <i class="fas fa-tv"></i>
                        {% elif equipment.category == 'Informatique' %}
                            <i class="fas fa-laptop"></i>
                        {% elif equipment.category == 'Éclairage' %}
                            <i class="fas fa-lightbulb"></i>
                        {% elif equipment.category == 'Chauffage/Climatisation' %}
                            <i class="fas fa-snowflake"></i>
                        {% else %}
                            <i class="fas fa-plug"></i>
                        {% endif %}
                    </div>
                    <h3>{{ equipment.name }}</h3>
                    <p class="equipment-category">{{ equipment.category }}</p>
                    <div class="equipment-power">
                        <strong>{{ equipment.puissance_watts }} W</strong>
                        <span>({{ (equipment.puissance_watts / 1000)|round(2) }} kW)</span>
                    </div>
                    <div class="equipment-info">
                        <small><i class="far fa-calendar"></i> Ajouté le {{ equipment.date_added.strftime('%d/%m/%Y') }}</small>
                    </div>
                    <div class="equipment-actions">
                        <a href="{{ url_for('edit_equipment', equipment_id=equipment.id) }}" class="btn-small btn-edit">
                            <i class="fas fa-edit"></i> Modifier
                        </a>
                        <a href="{{ url_for('delete_equipment', equipment_id=equipment.id) }}"
                            class="btn-small btn-delete"
                            onclick="return confirm('Supprimer cet équipement ?')">
                            <i class="fas fa-trash"></i> Supprimer
                        </a>
                    </div>
               </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <i class="fas fa-inbox" style="font-size: 4rem; color: #bdc3c7; margin-bottom: 1rem;"></i>
                <p>Vous n'avez pas encore d'équipement enregistré.</p>
                <a href="{{ url_for('add_equipment') }}" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Ajouter votre premier équipement
                </a>
            </div>
        {% endif %}
    </div>
</body>
</html>